machine:
  ruby:
    version: 2.3.1
test:
  pre:
    - "npm install -g bower"
    - "bower install"
    - "mysql -e 'create database revenger_test;'"
    - "cp ./config/database.travis.yml ./config/database.yml"
    - "RAILS_ENV=test bundle exec rake db:migrate"
    - "git checkout config/sunspot.yml"

deployment:
  production:
    branch: master
    commands:
      - bundle exec cap production deploy:
          timeout: 1500
  staging:
    branch: develop
    commands:
      - bundle exec cap staging-remote deploy:
          timeout: 1500
notify:
  webhooks:
    - url: https://idobata.io/hook/circle_ci/debc5621-f694-47bf-8f52-01aafec16b1d
